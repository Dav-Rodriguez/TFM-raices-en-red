<div class="dashboard-container">
  <header class="hero-banner">
    <div class="overlay">
      <h1>Bienvenido, {{ user?.names }}</h1>
      <p>
        Gestiona tus publicaciones y revisa las propuestas de los profesionales.
      </p>
    </div>
  </header>

  <div class="content-padding">
    <mat-card class="profile-card">
      <div class="profile-layout">
        <div class="profile-info">
          <h3>{{ user?.names }} {{ user?.lastnames }}</h3>
          <p><strong>Comunidad:</strong> {{ user?.communityName }}</p>
          <p class="description">
            Líder comunitario enfocado en el desarrollo sostenible.
          </p>
          <button mat-stroked-button color="accent">Actualizar perfil</button>
        </div>
        <div class="profile-image">
          <img src="assets/avatar-placeholder.png" alt="Perfil" />
        </div>
      </div>
    </mat-card>

    <div class="action-buttons">
      <button
        mat-raised-button
        color="primary"
        class="action-btn"
        routerLink="/create-problem"
      >
        <mat-icon>add</mat-icon> Crear publicación
      </button>
      <button mat-raised-button class="action-btn repo-btn">
        <mat-icon>library_books</mat-icon> Repositorio SbN
      </button>
    </div>

    <section class="section-container">
      <h4>Tus Publicaciones Activas</h4>

      <p *ngIf="myProblems.length === 0">
        Aún no has publicado ninguna problemática.
      </p>

      <mat-card class="item-card" *ngFor="let prob of myProblems">
        <div class="item-layout">
          <img
            [src]="prob.mainImage || 'assets/problem-placeholder.jpg'"
            class="thumbnail"
            alt="Problema"
          />

          <div class="item-text">
            <h5>{{ prob.title }}</h5>
            <p><strong>Ubicación:</strong> {{ prob.location }}</p>
            <p>{{ prob.description | slice : 0 : 100 }}...</p>
            <button mat-button color="primary" class="edit-btn">
              Gestionar
            </button>
          </div>
        </div>
      </mat-card>
    </section>

    <section class="section-container">
      <h4>Feed de Notificaciones y Propuestas</h4>

      <div class="no-data" *ngIf="receivedProposals.length === 0">
        <p>No has recibido propuestas técnicas aún.</p>
      </div>

      <div class="proposals-scroll">
        <mat-card
          class="notification-card"
          *ngFor="let prop of receivedProposals"
          [routerLink]="['/manage-proposal', prop._id]"
        >
          <div class="notification-layout">
            <div class="notif-content">
              <h5>Propuesta enviada por {{ prop.proposer?.names }}</h5>
              <p class="target-problem">Proyecto: {{ prop.problem?.title }}</p>
              <p class="excerpt">{{ prop.description | slice : 0 : 80 }}...</p>
            </div>

            <div class="notif-status">
              <img
                src="assets/prof-placeholder.png"
                class="mini-profile"
                alt="Profesional"
              />
              <span class="status-badge" [ngClass]="prop.status.toLowerCase()">
                {{ prop.status }}
              </span>
            </div>
          </div>
        </mat-card>
      </div>
    </section>
  </div>
</div>
